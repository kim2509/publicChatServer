<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.tessoft.nearhere.taxi.admin">

	<select id="selectUsersForEventPush" parameterType="java.util.HashMap"
		resultType="com.nearhere.domain.User">
		select * from user
		where regID is not null
		and appVersion > '1.33'
	</select>
	
	<select id="selectAdminForEventPush" parameterType="java.util.HashMap"
		resultType="com.nearhere.domain.User">
		select * from user
		where userID='user27'
	</select>
	
	<select id="selectUsersForLocationUpdate" parameterType="java.util.HashMap"
		resultType="com.nearhere.domain.User">
		select * from user
		where regID is not null
		and isDeleted is null
		and appVersion > '1.37'
	</select>
	
	<select id="selectUserForLocationUpdate" parameterType="java.util.HashMap"
		resultType="com.nearhere.domain.User">
		select * from user
		where regID is not null
		and userID=#{userID}
		and isDeleted is null
		and appVersion > '1.37'
	</select>
	
	<select id="selectAllUsers" parameterType="java.util.HashMap"
		resultType="com.nearhere.domain.User">
		select u.*, ul.address from user u
			left outer join user_location ul on u.userID = ul.userID and ul.locationName='현재위치'
		order by u.createdDate desc
		limit 0, 200
	</select>
	
	<select id="selectAllUsersWithLocation" parameterType="java.util.HashMap"
		resultType="java.util.HashMap">
		select u.userID, u.userName, ul.latitude as lat, ul.longitude as lng from user u
			left outer join user_location ul on u.userID = ul.userID and ul.locationName='현재위치'
		where isDeleted is null
		order by u.createdDate desc
	</select>
</mapper>